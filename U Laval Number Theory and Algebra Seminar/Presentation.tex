\documentclass{beamer}
\usetheme{Singapore}

% --------------------------------------------------------------------
% Packages pour la couleur
\usepackage{color}

% --------------------------------------------------------------------
% Voici certains packages souvent utilisés.
\usepackage{graphicx}		% Importation du package permettant d'inclure d'images dans le document.
\usepackage{amsmath, amsfonts}	% Pour écrire selon les standards de l'AMS.
\usepackage{epstopdf}		% Package permettant l'inclusion d'images eps, pour la compilation en pdf.
\usepackage{epsfig}
\usepackage{hyperref}
%\usepackage{subfig}
\usepackage{multirow}

% --------------------------------------------------------------------
% Le package "palatino" charge la police Palatino en mode texte et le package "euler" charge la police Euler en mode mathématique. Pour retrouver les polices par défaut, effacez les deux lignes de commandes qui suivent.
%\usepackage{palatino}
%\usepackage{euler}

% --------------------------------------------------------------------
% --------------------------------------------------------------------
% Commande rapide
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cW}{\mathcal{W}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cA}{\mathcal{A}}

\newcommand{\abcdmat}{\begin{pmatrix}
a & b \\ 
c & d
\end{pmatrix}}
\newcommand{\fa}{\mathfrak{a}}
\newcommand{\fb}{\mathfrak{b}}
\newcommand{\fc}{\mathfrak{c}}
\newcommand{\fp}{\mathfrak{p}}
\newcommand{\tpsi}{\theta_\psi}
\newcommand{\ClK}{\text{Cl}_K}

\DeclareMathOperator{\Ind}{Ind}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\Hom}{Hom}

\newtheorem{thm}{Theorem}
\newtheorem{defn}[thm]{Definition}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{coro}[thm]{Corollary}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{rem}[thm]{Remark}
\newtheorem{ex}[thm]{Example}
\newtheorem{qu}{Question}

\DeclareMathOperator{\reg}{reg}

\title{Petersson Inner Product of Theta Series}
\subtitle{An experimental approach}
\author{Nicolas \textsc{Simard}}
\institute{McGill University}
\date{December 1st, 2017}

\begin{document}

\frame{
	\titlepage
}

\section{Introduction}
\subsection{Motivation}
\frame{
	\frametitle{Stark's observation}
	Let $K=\Q(\sqrt{-23})$ and let $H$ be the HCF of $K$.
	Let
	\[\psi:\Gal(H/K)\rightarrow \text{GL}_1(\C)\]
	be a non-trivial one-dimensional Artin representation and let
	\[\rho =\Ind_{K}^{\Q}\psi:\Gal(H/\Q)\rightarrow\text{GL}_2(\C)\]
	be the induced representation. 
}

\frame{
	\frametitle{Stark's observation (cont.)}
	By Deligne-Serre, one has
	\[L(\rho, s) = L(\theta_\psi,s),\]
	where
	\[\tpsi(q) = \eta(q)\eta(23q) = q\prod_{n\geq 1}(1-q^n)(1-q^{23n})\in M_1(\Gamma_0(23),\chi_{-23}).\]
	Then Stark proves that
	\[\langle\tpsi,\tpsi\rangle = 3\log\varepsilon,\]
	where $\varepsilon$ is the real root of
	\[x^3-x-1.\]
}

\subsection{Structure of the Talk}
\frame{
	\frametitle{Structure of the talk}
	\tableofcontents
}

\frame{
	\frametitle{Notation}
	Throughout this talks, let
	\begin{itemize}
		\item $K$ be an imaginary quadratic field of discriminant $D$,
		\item $H$ be the Hilbert class field of $K$,
		\item $h_K$ be the class number of $K$,
		\item $w_K$ be the number of roots of unity in $K$ and
		\item $\ClK$ be the class group of $K$.
	\end{itemize}
}

\section[Weight One]{Petersson Inner Product of Weight One Theta Series}
\subsection{Explicit Formulas}
\frame{
	\frametitle{Weight one theta series}
	Let $\psi$ be a class character of $K$, i.e. a homomorphism
	\[\psi:\ClK\rightarrow\C^\times.\]
	Then
	\[\theta_\psi(q) = \sum_{\fa}\psi(\fa)q^{N(\fa)}\in M_1(\Gamma_0(|D|),\chi_D).\]
	
	\only<2->{
	\begin{itemize}
		\item $\theta_\psi$ is an eigenform for all Hecke operators;
		\item if $\psi^2 = 1$, $\theta_\psi$ is an Eisenstein series;
		\item if $\psi^2\neq 1$, $\theta_\psi$ is a cusp form (in fact, a newform).
	\end{itemize}
	}
}

\frame{
	\frametitle{Stark's example}
	Let
	\[K=\Q(\sqrt{-23})\]
	and let $\psi$ be a non-trivial class character as above.
	Then
	\[\text{Stark's }\tpsi =\text{our }\tpsi\in M_1(\Gamma_0(23),\chi_{-23}).\]
	Note that if $\psi'$ is the other non-trivial class character, then
	\[\theta_\psi = \theta_{\psi'}.\]
}

\frame{
	\frametitle{Petersson inner product of weight one theta series}
	The Petersson inner product of any two $f,g\in S_k(\Gamma_0(N),\chi)$ is defined as
	\[\langle f,g\rangle =\iint_{\Gamma_0(N)\setminus\cH}f(x+iy)\overline{g(x+iy)}y^k\text{d}\mu.\]
	\only<2->{
	\begin{prop}[S.]
		Let $\psi$ be a class character which is not a genus character. Then
		\[\langle\theta_\psi,\theta_\psi\rangle = \frac{-h_K}{3w_K^2}\sum_{\cA\in\ClK}\psi^2(\cA)\log N(\cA)^6|\Delta(\cA)|.\]
	\end{prop}
	}
}


\subsection{Generalizing Stark's Observation}
\frame{
	\frametitle{Siegel units}
	Define
	\[|\delta_\cA|=(N(\fa)^6|\Delta(\cO_K)/\Delta(\fa^{-1})|)^{h_K},\]
	where $\fa$ is any ideal in the class $\cA$.
	Then $|\delta_\cA|$ is the absolute value of a (Siegel) unit in $H$.
	
	\only<2->{
	Since $\psi^2$ is not trivial, one sees that
	\[\langle \theta_\psi,\theta_\psi\rangle = \frac{1}{3w_K^2}\sum_{\cA\in\ClK}\psi^2(\cA)\log |\delta_\cA|.\]
	}
}

\frame{
	\frametitle{What about Stark's observation?}
	Assume $D<-4$.
	Then one can write
	\[\langle \theta_\psi,\theta_\psi\rangle = \frac{-h_K}{3w_K^2}\sum_{\cA\in\ClK}\psi^2(\cA)\log N(\cA)^6|\Delta(\cA)| = h_K\log\kappa_\psi.\]
	Here,
	\[\kappa_\psi = \prod_{\cA\in\ClK}\Phi(\cA)^{-\psi^2(\cA)}\]
	with
	\[\Phi(\cA) = \sqrt{N(\fa)}|\Delta(\fa)|^{1/12},\]
	where $\fa$ is any ideal in the class $\cA$.
	
	\only<2->{
	\begin{qu}
		Is $\kappa_\psi$ a unit in $H$?
	\end{qu}
	
	Script available at \url{https://github.com/NicolasSimard/ENT/blob/master/comps/ULcomps1.gp}
	}
}

\frame{
	\frametitle{Generalizing Stark's Observation}
	\begin{prop}[S.]
	Let $\psi$ be a class character such that $\psi^2$ is a non-trivial character with rational real part.
	Then $\kappa_\psi$ is an algebraic integer which is a unit.
	Moreover, if $\psi^2$ is a non-trivial genus character corresponding to the factorisation $D = D_1D_2$, with $D_1>0$ say, then
	\[\kappa_\psi = \epsilon_{D_1}^{\frac{4h_{D_1}h_{D_2}}{w_Kw_{D_2}}},\]
	where $\epsilon_{D_1}$ is the fundamental unit of $\Q(\sqrt{D_1})$, $h_{D_j}$ is the class number of $\Q(\sqrt{D_j})$ and $w_{D_2}$ is the number of roots of unity in $\Q(\sqrt{D_2})$.
	\end{prop}
}

\frame{
	\frametitle{Stark's observation: the final word?}
	Note that $\psi^2$ has rational real part if and only if its order divides $4$ or $3$.
	\begin{coro}
		Suppose that $K$ has class number divisible by $2$ or $3$.
		Then there exists a class character $\psi$ for which $\kappa_\psi$ is a unit.
	\end{coro}
	
	\only<2->{
	\begin{qu}
		Is the converse true?
	\end{qu}
	}
}

\section[Higher Weight]{Petersson Inner Product of Higher Weight Theta Series}
\subsection{Explicit formulas}
\frame{
	\frametitle{Higher weight theta series}
	Let $\ell$ be a positive integer and let $\psi$ be a Hecke character of infinity type $(2\ell, 0)$, i.e. a homomorphism
	\[\psi:I_K\rightarrow\C^\times\]
	such that
	\[\psi(\alpha\cO_K)=\alpha^{2\ell}\text{ for all }\alpha\in K^\times.\]
	Then
	\[\theta_\psi(q) = \sum_{\fa}\psi(\fa)q^{N(\fa)}\in M_{2\ell + 1}(\Gamma_0(|D|),\chi_D).\]
	
	\only<2->{
	\begin{itemize}
		\item For $\ell=0$, one recovers the weight one theta series introduced before;
		\item for $\ell>0$, $\theta_\psi$ is a newform.
	\end{itemize}
	}
}

\frame{
	\frametitle{Recall}
	Let
	\[E_2(\tau) = \frac{1}{8\pi\Im(\tau)}-\frac{1}{24} + \sum_{n=1}^\infty\sigma(n)q^n\]
	be the nearly holomorphic weight $2$ Eisenstein series and let
	\[E_k(q) = -\frac{B_k}{2k}+\sum_{n=1}^\infty\sigma_{k-1}(n)q^n\]
	be the usual weight $k$ Eisenstein series for $k\geq 4$, where $q = e^{2\pi i\tau}$.
	
	\only<2->{
	Let also $\delta$ be the Shimura-Maass differential operator, so that
	\[\delta E_k =\frac{1}{2\pi i}\frac{\partial E_k}{\partial \tau}-\frac{k}{4\pi\Im(\tau)}E_k.\]
	Then $\partial$ raises the weight by $2$ and preserves the graded ring
	\[\C[E_2,E_4,E_6]\]
	of nearly holomorphic modular forms of level $\text{SL}_2(\Z)$.
	}
}

\frame{
	\frametitle{Petersson inner product of higher weight theta series}
	With the above notation, one has the following
	\begin{prop}[S.]
		Let $\ell>0$ and let $\psi$ be a Hecke character of infinity type $(2\ell,0)$.
		Then
		\[\langle \theta_\psi,\theta_\psi\rangle = (|D|/4)^\ell\frac{4h_K}{w_K^2}\sum_{\cA\in\ClK}\psi^2(\cA)\delta^{2\ell-1} E_2(\cA).\]
	\end{prop}
}

\subsection{$p$-adic interpolation of Petersson inner product of theta series}

\frame{
	\frametitle{Theta series attached to ideals}
	Let $\ell\geq0$ and let $\fa$ be a fractional ideal of $K$ and define
	\[\theta_{\fa,\ell}(q)=\sum_{x\in\fa}x^{2\ell}q^{N(x)/N(\fa)}\in M_{2\ell+1}(\Gamma_0(|D|),\chi_D),\]
	where $\chi_D$ is the Kronecker symbol.
	
	\only<2->{
	\begin{itemize}
		\item If $\ell>0$, then
	\[\theta_{\fa,\ell}\in S_{2\ell+1}(\Gamma_0(|D|),\chi_D).\]
		\item For any $\ell\geq 0$, one has	
		\[\theta_{\fa,\ell}=\frac{w_K}{h_K}\sum_{\psi}\psi(\fa)\theta_\psi,\]
		where the sum is over the $h_K$ Hecke characters of infinity type $(2\ell,0)$.			
		\end{itemize}
	}
}

\frame{
	\frametitle{Petersson inner product of theta series attached to ideals}
	Using the above relation between the two set of theta series, one has the following
	\begin{coro}
		Let $\ell>0$ and let $\fa$ and $\fb$ be two fractional ideals of $K$. Then 
		\[\langle\theta_{\fa,\ell},\theta_{\fb,\ell}\rangle=4(|D|/4)^\ell\sum_{\fa\bar{\fb}\fc^2=\lambda_\fc\cO_K}\lambda_\fc^{2\ell}\delta^{2\ell-1}E_2(\fc),\]
		where the sum is over a set of representatives $\fc$ of ideals classes in $\ClK$ such that $\fa\bar{\fb}\fc^2=\lambda_\fc\cO_K$.
	\end{coro}
}

\frame{
	\frametitle{Algebrizing the Petersson inner product}
	Recall that
	\[\delta^n E_2\in\C[E_2, E_4, E_6].\]
	
	There are two ways to algebrize CM values of modular forms.
	
	\only<2>{
	\begin{prop}[Chowla-Selberg period]
		Let
		\[\Omega_K =\frac{1}{\sqrt{4\pi|D|}}\left (\prod_{n=1}^{|D|-1}\Gamma\left (\frac{n}{|D|}\right )^{\chi_D(n)}\right )^{w_K/(4h_K)}\]
		and let $\fc$ be a fractional ideal of $K$.
		Then
		\[E_k(\fc)\in\Omega_K^k\bar{\Q}\]
		for $k=2,4$ and $6$.
	\end{prop}
	}
	
	\only<3>{
	\begin{prop}[CM theory]
		Let $\Omega_\fc\in\C^\times$ be such that the elliptic curve
		\[\C/\Omega_\fc \fc\]
		is defined over $H$.
		Then
		\[E_k(\fc)\in(2\pi i\Omega_\fc)^{-k} H\]
		for $k=2,4$ and $6$.
	\end{prop}
	}
	
	\only<2->{
	Script available at \url{https://github.com/NicolasSimard/ENT/blob/master/comps/ULcomps2.gp}
	}
}

\frame{
	\frametitle{$p$-adic interpolation of Petersson inner product of theta series}
	\only<1>{Suppose that $D$ is prime and let $p$ be a prime $\neq2,3$ which splits in $K$, say $p\cO_K=\fp\bar{\fp}$.
	
	Let $\fa$ and $\fb$ be two fractional ideals of $K$ which are such that
	\[\fa\overline{\fb}\fc^2=\cO_K\]
	and fix an isomorphism
	\[\Q_p/\Z_p\rightarrow\bigcup_{n\geq 1}\bar{\fp}^{-n}\fc/\fc.\]
	
	Let also
	\[\cW=\Hom_{\text{cont}}(\Z_p^\times,\Z_p^\times)\]
	denote the $p$-adic weight space.
	}
	
	\only<2>{
	With the notation above, one has the following
	\begin{theorem}[S.]
	There exists a $p$-adic analytic function
	\[F:\cW\rightarrow\C_p\]
	with the property that
	\[F(\ell) = (\Frob_\fp^{-1}-p^{2\ell-1})(\Frob_\fp^{-1}-p^{2\ell})\left (\frac{\langle\theta_{\fa,\ell},\theta_{\fb,\ell}\rangle}{(2\pi i\Omega_\fc)^{-4\ell}}\right )\text{for all }\ell>0,\]
	where $\Frob_\fp = \left (\frac{H/K}{\fp}\right )$ is the Artin symbol.
	\end{theorem}
	}
}

\frame{
	\frametitle{"Petersson inner product" of weight one theta series}
	Recall that
	\[\theta_{\fa,0}\in M_1(\Gamma_0(|D|),\chi_D).\]
	Using the relation
	\[\theta_{\psi}(q)=\frac{1}{w_K}\sum_{j=1}^{h_K}\psi^{-1}(\fa_j)\theta_{\fa_j,\ell}(q)\]
	and the explicit formulas for $\langle\theta_\psi,\theta_\psi\rangle$, one has \emph{formally}
	\[\langle\theta_{\fa,0},\theta_{\fb,0}\rangle=\frac{-1}{3}\log(N(\fc)^6|\Delta(\fc)|)\]
	when $D$ is prime.
}

\frame{
	\frametitle{Value of $F$ outside the range of interpolation}
	With the same notation as before, one has the following
	\begin{theorem}[S.]
	Let $g_0^{(p)}$ be the $p$-adic modular form with $q$-expansion
	\[g_0^{(p)}(q) = \frac{\Delta(q^p)^{p+1}}{\Delta(q)^p \Delta(q^{p^2})}.\]
	Then
	\[F(0) = \frac{-1}{6p}\log_pg_0^{(p)}(P_\fc),\]
	where $P_\fc$ is a trivialized CM Elliptic curve attached to $\fc$.
	\end{theorem}
}

\frame{
	\frametitle{A formal computation}
	Formally, one sees that
	\begin{align*}
		F(0) &= \frac{-1}{6p}\log_pg_0^{(p)}(P_\fc)\\
			 &= \frac{-1}{6}(\Frob_{\fp}^{-1}-p^{-1})(\Frob_{\fp}^{-1}-1)\log_p\Delta(\fc)
	\end{align*}
	\only<2->{
	Compare with
	\[F(\ell) = (\Frob_\fp^{-1}-p^{2\ell-1})(\Frob_\fp^{-1}-p^{2\ell})\left (\frac{\langle\theta_{\fa,\ell},\theta_{\fb,\ell}\rangle}{(2\pi i\Omega_\fc)^{-4\ell}}\right )\]
	at $\ell = 0$ with the formal expression
	\[\langle\theta_{\fa,0},\theta_{\fb,0}\rangle=\frac{-1}{3}\log(N(\fc)^6|\Delta(\fc)|).\]
	}
}

\section{Spaces of Theta Series}

\frame{
	\frametitle{Thank you!}
	
	Presentation and notes available at: \url{https://github.com/NicolasSimard/Notes}
	
	Code available at : \url{https://github.com/NicolasSimard/ENT}
	
	Or from my webpage: \url{http://www.math.mcgill.ca/nsimard/}
}
\end{document}
